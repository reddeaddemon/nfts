<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mint Devnet NFT</title>
</head>
<body>
  <h1>Mint Your NFT on Solana Devnet</h1>
  <button id="connectBtn">Connect Phantom</button>
  <button id="mintBtn" disabled>Mint NFT</button>
  <p id="status"></p>

  <script src="https://unpkg.com/@solana/web3.js@1.73.0/lib/index.iife.js"></script>
  <script src="https://unpkg.com/@metaplex-foundation/js@1.5.0/dist/index.iife.js"></script>

  <script>
    const connectBtn = document.getElementById('connectBtn');
    const mintBtn = document.getElementById('mintBtn');
    const status = document.getElementById('status');

    let provider;
    let metaplex;

    // Replace with your GitHub-hosted metadata.json
    const METADATA_URL = "https://reddeaddemon.github.io/nfts/metadata.json";

    connectBtn.onclick = async () => {
      if (!window.solana || !window.solana.isPhantom) {
        status.innerText = "Phantom not found. Install Phantom extension.";
        return;
      }

      try {
        await window.solana.connect();
        provider = window.solana;
        metaplex = new metaplexJs.Metaplex(new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('devnet')))
          .use(metaplexJs.walletAdapterIdentity({ publicKey: provider.publicKey, signTransaction: provider.signTransaction, signAllTransactions: provider.signAllTransactions }));

        status.innerText = "Connected: " + provider.publicKey.toString();
        mintBtn.disabled = false;
      } catch (err) {
        status.innerText = "Error connecting Phantom: " + err.message;
      }
    };

    mintBtn.onclick = async () => {
      try {
        status.innerText = "Minting NFT...";
        const { nft } = await metaplex.nfts().create({
          uri: METADATA_URL,
          name: "My Test Song NFT",
          sellerFeeBasisPoints: 0, // No royalty
        });
        status.innerText = "NFT minted! Mint address: " + nft.address.toString();
      } catch (err) {
        console.error(err);
        status.innerText = "Error minting NFT: " + err.message;
      }
    };
  </script>
</body>
</html>

